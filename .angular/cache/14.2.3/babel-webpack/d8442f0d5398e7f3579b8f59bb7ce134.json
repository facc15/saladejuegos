{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Facundo/Desktop/Angular/TP/saladejuegos/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { collectionData } from '@angular/fire/firestore';\nimport { addDoc, collection, doc, updateDoc } from 'firebase/firestore';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/fire/compat/firestore\";\nimport * as i2 from \"@angular/fire/compat/auth\";\nexport class ResultadosService {\n  constructor(afs, afAuth) {\n    this.afs = afs;\n    this.afAuth = afAuth;\n    this.user = {};\n    this.afAuth.authState.subscribe(user => {\n      if (!user) {\n        return;\n      }\n\n      this.user.displayName = user.displayName;\n      this.user.email = user.email;\n      this.user.photoUrl = user.photoURL;\n      this.user.uid = user.uid;\n      console.log(this.user);\n    });\n  }\n\n  guardarResultado(juego, puntaje) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        const docRef = yield addDoc(collection(_this.afs.firestore, juego), {\n          puntaje: puntaje,\n          correo: _this.user.email,\n          nombre: _this.user.displayName,\n          uid: _this.user.uid,\n          fecha: new Date()\n        });\n        console.log(\"Documento escrito en colección: \", docRef.id);\n        _this.user.id = docRef.id;\n      } catch (e) {\n        console.error(\"Error al agregar document: \", e);\n      }\n    })();\n  }\n\n  actualizarResultado(juego, puntaje) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      const placeRef = doc(_this2.afs.firestore, juego, _this2.user.id);\n      yield updateDoc(placeRef, {\n        puntaje: puntaje\n      }).then(res => {});\n    })();\n  }\n\n  guardarResultadoPokemon(juego, victorias, derrotas) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        const docRef = yield addDoc(collection(_this3.afs.firestore, juego), {\n          victorias: victorias,\n          derrotas: derrotas,\n          correo: _this3.user.email,\n          nombre: _this3.user.displayName,\n          uid: _this3.user.uid,\n          fecha: new Date()\n        });\n        console.log(\"Documento escrito en colección: \", docRef.id);\n        _this3.user.id = docRef.id;\n      } catch (e) {\n        console.error(\"Error al agregar document: \", e);\n      }\n    })();\n  }\n\n  actualizarResultadoPokemon(gano, juego, puntaje) {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      if (gano) {\n        const placeRef = doc(_this4.afs.firestore, juego, _this4.user.id);\n        yield updateDoc(placeRef, {\n          victorias: puntaje\n        });\n      } else {\n        const placeRef = doc(_this4.afs.firestore, juego, _this4.user.id);\n        yield updateDoc(placeRef, {\n          derrotas: puntaje\n        });\n      }\n    })();\n  }\n\n  traerResultados(juego) {\n    let placeRef = collection(this.afs.firestore, juego);\n    return collectionData(placeRef, {\n      idField: 'id'\n    });\n  }\n\n}\n\nResultadosService.ɵfac = function ResultadosService_Factory(t) {\n  return new (t || ResultadosService)(i0.ɵɵinject(i1.AngularFirestore), i0.ɵɵinject(i2.AngularFireAuth));\n};\n\nResultadosService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: ResultadosService,\n  factory: ResultadosService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"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","names":["collectionData","addDoc","collection","doc","updateDoc","ResultadosService","constructor","afs","afAuth","authState","subscribe","user","displayName","email","photoUrl","photoURL","uid","console","log","guardarResultado","juego","puntaje","docRef","firestore","correo","nombre","fecha","Date","id","e","error","actualizarResultado","placeRef","then","res","guardarResultadoPokemon","victorias","derrotas","actualizarResultadoPokemon","gano","traerResultados","idField","i0","factory","providedIn"],"sourceRoot":"","sources":["C:\\Users\\Facundo\\Desktop\\Angular\\TP\\saladejuegos\\src\\app\\servicios\\resultados.service.ts"],"sourcesContent":["import { User } from './../interfaces/user';\nimport { AuthService } from 'src/app/servicios/auth.service';\nimport { Injectable } from '@angular/core';\nimport { AngularFirestore } from '@angular/fire/compat/firestore';\nimport { collectionData, Firestore } from '@angular/fire/firestore';\nimport { addDoc, collection, doc, updateDoc } from 'firebase/firestore';\nimport { AngularFireAuth } from '@angular/fire/compat/auth';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ResultadosService {\n  private user: any={};\n\n  constructor(private afs: AngularFirestore,private afAuth: AngularFireAuth) {\n    this.afAuth.authState.subscribe(user=>{\n      if(!user)\n      {\n        return ;\n      }\n     \n        this.user.displayName= user.displayName;\n        this.user.email= user.email;\n        this.user.photoUrl= user.photoURL;\n        this.user.uid= user.uid;\n\n\n      console.log(this.user);\n      });\n\n   }\n\n  async guardarResultado(juego: string,puntaje: number)\n  {\n    try {\n      const docRef = await addDoc(collection(this.afs.firestore,juego), {\n        puntaje: puntaje,\n        correo: this.user.email,\n        nombre: this.user.displayName,\n        uid: this.user.uid,\n        fecha: new Date(),\n      });\n      console.log(\"Documento escrito en colección: \", docRef.id);\n      this.user.id=docRef.id;\n    } catch (e) {\n      console.error(\"Error al agregar document: \", e);\n\n    }\n  }\n  async actualizarResultado(juego: string, puntaje: number) {\n    \n    const placeRef = doc(this.afs.firestore,juego,this.user.id);\n    await updateDoc(placeRef, { puntaje: puntaje } ).then(res=>{\n    });\n  }\n\n  \n  async guardarResultadoPokemon(juego: string,victorias: number,derrotas: number)\n  {\n   \n      try {\n        const docRef = await addDoc(collection(this.afs.firestore,juego), {\n          victorias: victorias,\n          derrotas: derrotas,\n          correo: this.user.email,\n          nombre: this.user.displayName,\n          uid: this.user.uid,\n          fecha: new Date(),\n        });\n        console.log(\"Documento escrito en colección: \", docRef.id);\n        this.user.id=docRef.id;\n      } catch (e) {\n        console.error(\"Error al agregar document: \", e);\n  \n      }\n    \n  }\n\n  async actualizarResultadoPokemon(gano: boolean,juego: string, puntaje:number) {\n    \n    if(gano)\n    {\n      const placeRef = doc(this.afs.firestore,juego,this.user.id);\n    await updateDoc(placeRef, { victorias: puntaje } );\n    }else\n    {\n      const placeRef = doc(this.afs.firestore,juego,this.user.id);\n      await updateDoc(placeRef, { derrotas: puntaje } );\n    }\n    \n    \n  }\n\n  traerResultados(juego: string)\n  {\n    let placeRef=collection(this.afs.firestore,juego);\n    return collectionData(placeRef,{idField:'id'});\n\n  }\n\n\n\n\n}\n"]},"metadata":{},"sourceType":"module"}